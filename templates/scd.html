{% extends "base.html" %}
{% block title %}Service Computation Date Calculator{% endblock %}

{% block content %}

<h2 class="mb-4">üìÖ Service Computation Date (SCD) Calculator</h2>

<form method="POST">
  <div class="mb-3">
    <label class="form-label">Current Federal Service Start Date</label>
    <input type="date" class="form-control" name="current_start" required>
  </div>

  <h5>Add Prior Creditable Service Periods:</h5>
  <div id="service-periods" class="mb-3"></div>

  <button type="button" class="btn btn-secondary mb-3" onclick="addPeriod()">‚ûï Add Another Period</button><br>
  <button type="submit" class="btn btn-primary">üßÆ Calculate SCD</button>
</form>

<a href="{{ url_for('index') }}" class="btn btn-link mt-3">‚Üê Back to Home</a>

{% if scd %}
  <div class="alert alert-success mt-4">
    üìÖ <strong>Your Adjusted Service Computation Date:</strong> {{ scd }}
  </div>
{% elif error %}
  <div class="alert alert-danger mt-4">{{ error }}</div>
{% endif %}

<script>
function addPeriod() {
  const container = document.getElementById('service-periods');
  const wrapper = document.createElement('div');
  wrapper.classList.add('row', 'mb-2', 'align-items-center', 'service-period-entry');

  wrapper.innerHTML = `
    <div class="col">
      <input type="date" class="form-control" name="prior_start[]" required>
    </div>
    <div class="col">
      <input type="date" class="form-control" name="prior_end[]" required>
    </div>
    <div class="col-auto">
      <button type="button" class="btn btn-outline-danger btn-sm" onclick="this.closest('.service-period-entry').remove()">üóëÔ∏è</button>
    </div>
  `;

  container.appendChild(wrapper);
}
</script>

<div class="mt-5 p-3 bg-light border rounded">
    <h6 class="text-muted">‚ö†Ô∏è Important Caveats</h6>
    <ul class="small">
      <li>This calculator provides an estimated <strong>adjusted Service Computation Date (SCD)</strong> based solely on the service periods you enter. It does not account for:
        <ul>
          <li>Deposit or redeposit service not paid back</li>
          <li>Periods of non-creditable time (e.g., some temp or contract service)</li>
          <li>Military service that wasn‚Äôt bought back</li>
          <li>Agency-specific adjustments or automated HR calculations</li>
        </ul>
      </li>
      <li>The SCD calculated here is for general reference only and may differ from your official SCD(s) for <strong>Leave, Retirement, or Reduction-in-Force (RIF)</strong> purposes.</li>
      <li>For authoritative information on what qualifies as creditable service for various SCD types, refer to official <a href="https://www.opm.gov" target="_blank">OPM guidance</a> or consult with your HR office.</li>
    </ul>
  </div>
  
{% endblock %}
