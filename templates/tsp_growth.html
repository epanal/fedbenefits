{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">TSP Growth Calculator</h2>
    <form method="POST">
        <div class="mb-3">
            <label for="current_balance" class="form-label">Current Account Balance ($)</label>
            <input type="number" step="0.01" class="form-control" name="current_balance" required>
        </div>
        <div class="mb-3">
            <label for="annual_contribution" class="form-label">Annual Contribution + TSP Match ($)</label>
            <input type="number" step="0.01" class="form-control" name="annual_contribution" required>
        </div>
        <div class="mb-3">
            <label for="years" class="form-label">Number of Years Until Retirement</label>
            <input type="number" class="form-control" name="years" required>
        </div>
        <div class="mb-3">
            <label for="annual_rate" class="form-label">Expected Annual Rate of Return (%)</label>
            <input type="number" step="0.1" class="form-control" name="annual_rate" value="6.5" required>
        </div>
        <button type="submit" class="btn btn-primary">Calculate</button>
    </form>

    {% if result %}
    <hr>
    <h3 class="mt-4">Results</h3>
    <p><strong>Estimated Future Balance:</strong> ${{ "{:,.2f}".format(result.future_value) }}</p>
    <p><strong>Total Contributions:</strong> ${{ "{:,.2f}".format(result.total_contributions) }}</p>
    <p><strong>Total Growth:</strong> ${{ "{:,.2f}".format(result.growth) }}</p>

    <canvas id="tspChart" width="400" height="200"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        var ctx = document.getElementById('tspChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Contributions', 'Growth'],
                datasets: [{
                    data: [{{ result.total_contributions }}, {{ result.growth }}],
                    backgroundColor: ['#007bff', '#28a745']
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Breakdown of Contributions vs. Growth'
                    }
                }
            }
        });
    </script>
    {% endif %}
</div>
{% endblock %}